CREATE TABLE account (id INT UNSIGNED AUTO_INCREMENT, email VARCHAR(255) NOT NULL UNIQUE, slug VARCHAR(255) NOT NULL UNIQUE, salt VARCHAR(255) NOT NULL, password VARCHAR(255) NOT NULL, state VARCHAR(255) NOT NULL, last_login DATETIME NOT NULL, validation_code VARCHAR(45), culture VARCHAR(3) NOT NULL, currency VARCHAR(3) NOT NULL, type VARCHAR(255) NOT NULL, created_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE account_forgot_password (account_id INT UNSIGNED NOT NULL, unique_key VARCHAR(255), expires_at DATETIME NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX account_id_idx (account_id), PRIMARY KEY(unique_key)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE account_remember_key (account_id INT UNSIGNED NOT NULL, remember_key VARCHAR(32), ip_address VARCHAR(50), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX account_id_idx (account_id), PRIMARY KEY(remember_key)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE frapp (id INT UNSIGNED AUTO_INCREMENT, name VARCHAR(50) NOT NULL, admins TEXT, slug VARCHAR(250) NOT NULL UNIQUE, slogan VARCHAR(250), state VARCHAR(255) NOT NULL, filename VARCHAR(255), logo_x1 SMALLINT, logo_y1 SMALLINT, logo_x2 SMALLINT, logo_y2 SMALLINT, sourceimage_w SMALLINT, sourceimage_h SMALLINT, state_support_sponsor TINYINT UNSIGNED DEFAULT 0, sponsor_accept_pledge TINYINT UNSIGNED DEFAULT 0, sponsor_goal TINYINT UNSIGNED DEFAULT 0, state_support_campaign TINYINT UNSIGNED DEFAULT 0, campaign_raise_money TINYINT UNSIGNED DEFAULT 0, state_support_promote TINYINT UNSIGNED DEFAULT 0, state_support_petition TINYINT UNSIGNED DEFAULT 0, parent_id INT UNSIGNED, expires_at DATE, creator_id INT UNSIGNED NOT NULL, created_at DATETIME NOT NULL, INDEX creator_id_idx (creator_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE frapp_mdl (id INT UNSIGNED AUTO_INCREMENT, slug VARCHAR(255), name VARCHAR(100) NOT NULL, type_key VARCHAR(10) NOT NULL, frapp_id INT UNSIGNED NOT NULL, position BIGINT, UNIQUE INDEX frapp_mdl_sluggable_idx (slug, frapp_id), UNIQUE INDEX sortable_idx (position, frapp_id), INDEX frapp_id_idx (frapp_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE location (id INT UNSIGNED AUTO_INCREMENT, city VARCHAR(100) NOT NULL, region VARCHAR(100) NOT NULL, country VARCHAR(2) NOT NULL, lang VARCHAR(2) NOT NULL, population MEDIUMINT UNSIGNED DEFAULT '0' NOT NULL, INDEX city_idx (city), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE profile_company (account_id INT UNSIGNED, name VARCHAR(100), brand_name VARCHAR(100), slogan VARCHAR(250), cui VARCHAR(100), contact_name VARCHAR(100), contact_job_title VARCHAR(100), contact_email VARCHAR(100), contact_phone VARCHAR(100), location_id INT UNSIGNED, INDEX location_id_idx (location_id), PRIMARY KEY(account_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE profile_organization (account_id INT UNSIGNED, name VARCHAR(100), brand_name VARCHAR(100), slogan VARCHAR(250), cui VARCHAR(100), contact_name VARCHAR(100), contact_job_title VARCHAR(100), contact_email VARCHAR(100), contact_phone VARCHAR(100), location_id INT UNSIGNED, INDEX location_id_idx (location_id), PRIMARY KEY(account_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE profile_person (account_id INT UNSIGNED, first_name VARCHAR(100), last_name VARCHAR(100), slogan VARCHAR(250), date_of_birth DATE, gender VARCHAR(255), location_id INT UNSIGNED, INDEX location_id_idx (location_id), PRIMARY KEY(account_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
ALTER TABLE account_forgot_password ADD CONSTRAINT account_forgot_password_account_id_account_id FOREIGN KEY (account_id) REFERENCES account(id) ON DELETE CASCADE;
ALTER TABLE account_remember_key ADD CONSTRAINT account_remember_key_account_id_account_id FOREIGN KEY (account_id) REFERENCES account(id) ON DELETE CASCADE;
ALTER TABLE frapp ADD CONSTRAINT frapp_creator_id_account_id FOREIGN KEY (creator_id) REFERENCES account(id) ON DELETE CASCADE;
ALTER TABLE frapp_mdl ADD CONSTRAINT frapp_mdl_frapp_id_frapp_id FOREIGN KEY (frapp_id) REFERENCES frapp(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE profile_company ADD CONSTRAINT profile_company_location_id_location_id FOREIGN KEY (location_id) REFERENCES location(id);
ALTER TABLE profile_organization ADD CONSTRAINT profile_organization_location_id_location_id FOREIGN KEY (location_id) REFERENCES location(id);
ALTER TABLE profile_person ADD CONSTRAINT profile_person_location_id_location_id FOREIGN KEY (location_id) REFERENCES location(id);
